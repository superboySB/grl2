#!/bin/zsh


algos=(
    # ppo
    # ppo2
    # ppg
    # apex-mrdqn
    apex-sacdiqn
    # apex-sacdiqn2
    # sacdiqn5
)
suite=procgen
envs=(
    plunder
    # chaser
    bigfish
    # starpilot
    # coinrun
    # miner
    # caveflyer 
    # climber
    # dodgeball 
    # leaper
    # jumper
    # fruitbot
    # heist
    # ninja
    # bossfight
    # maze
)
args1=(True False)
args2=(glorot_uniform)
args3=(conv_maxblurpool)

for e in "${envs[@]}"; do
    for a in "${algos[@]}"; do
        for a1 in "${args1[@]}"; do
            for a2 in "${args2[@]}"; do
                for a3 in "${args3[@]}"; do
                    sed -e "s/KI/${a2}/g" \
                        algo/ppo/${suite}_template.yaml > algo/ppo/${suite}_config.yaml
                    dir="logs/${suite}_${e}/${a}"
                    mkdir -p $dir
                    # py_script="train ${a} -e ${suite}_${e} $@ >& ${dir}/outputs.txt"
                    py_script="train ${a} -e ${suite}_${e} -kw actor_adv=$a1 max_steps=3 >& ${dir}/outputs.txt"
                    echo $py_script
                    eval $py_script
                    last_dir=$(ls -td ${dir}/* | grep -v txt | head -n 1)
                    mv_script="mv ${dir}/outputs.txt ${last_dir}/outputs.txt"
                    echo $mv_script
                    eval $mv_script
                done
            done
        done
    done
done

# for e in "${envs[@]}"; do
#     for a in "${algos[@]}"; do
#         for a1 in "${args1[@]}"; do
#             for a2 in "${args2[@]}"; do
#             dir="logs/${suite}_${e}/${a}"
#             mkdir -p $dir
#             # py_script="train ${a} -e ${suite}_${e} -v info $@ >& ${dir}/outputs.txt"
#             py_script="train ${a} -e ${suite}_${e} -v info -kw cnn_name=procgen subsample=$a1 kernel_initializer=$a2 >& ${dir}/outputs.txt"
#             echo $py_script
#             eval $py_script
#             last_dir=$(ls -td ${dir}/* | grep -v txt | head -n 1)
#             mv_script="mv ${dir}/outputs.txt ${last_dir}/outputs.txt"
#             echo $mv_script
#             eval $mv_script
#             done
#         done
#     done
# done
